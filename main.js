(()=>{"use strict";class e{constructor(e,t){this._form=t,this._validationConfig=e,this._inputs=Array.from(this._form.querySelectorAll(this._validationConfig.inputSelector)),this.submitButton=this._form.querySelector(this._validationConfig.submitButtonSelector)}enableValidation(){this._addEventListeners()}_addEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValid(e),this.toggleButtonState(this._inputs,this._button)}))}))}_checkInputValid=e=>{const t=this._form.querySelector(`#${e.id}-error`);e.validity.valid?(t.classList.add(this._validationConfig.errorClass),e.classList.remove(this._validationConfig.inputErrorClass)):(t.textContent=e.validationMessage,t.classList.remove(this._validationConfig.errorClass),e.classList.add(this._validationConfig.inputErrorClass))};toggleButtonState=()=>{this._inputs.every((e=>e.validity.valid))?(this.submitButton.classList.remove(this._validationConfig.inactiveButtonClass),this.submitButton.disabled=""):(this.submitButton.classList.add(this._validationConfig.inactiveButtonClass),this.submitButton.disabled="disabled")};resetInputError(){this._inputs.forEach((e=>{const t=this._form.querySelector(`#${e.id}-error`);t.classList.remove(this._validationConfig.errorClass),e.classList.remove(this._validationConfig.inputErrorClass),t.textContent=" "}))}}class t{constructor(e,t,s){this._elementsTemplate=t,this.item=e,this._handleCardClick=s}_toggleLike=e=>{e.target.classList.toggle("elements__heart_active")};_deleteCard=e=>{e.target.closest(".elements__item").remove()};_handleClickImage=()=>{this._handleCardClick(this.item.link,this.item.name)};_getTemplateElement=()=>document.querySelector(this._elementsTemplate).content.querySelector(".elements__item");_addEventListeners(){const e=this._elm.querySelector(".elements__delete"),t=this._elm.querySelector(".elements__heart");e.addEventListener("click",this._deleteCard),t.addEventListener("click",this._toggleLike),this._elmPhoto.addEventListener("click",(()=>this._handleClickImage()))}createElement(){const e=this._getTemplateElement();return this._elm=e.cloneNode(!0),this._elm.querySelector(".elements__name").textContent=this.item.name,this._elmPhoto=this._elm.querySelector(".elements__photo"),this._elmPhoto.src=this.item.link,this._elmPhoto.alt="Фото "+this.item.name,this._addEventListeners(),this._elm}}class s{constructor(e){this._popup=document.querySelector(e)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("click",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.name,n=t.value;e[s]=n})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>this._handleSubmit(e,this._getInputValues())))}close(){super.close(),this._form.reset()}setFormvalues(e){console.log(this._inputs),console.log(e),this._inputs.forEach((t=>{const s=t.name;e[s]&&(t.value=e[s])}))}}const i=document.querySelector(".profile"),o=document.querySelector(".popup__submit-form"),r=document.querySelector(".add-popup__submit-form"),a=(document.querySelector(".add-popup__input_description_name"),document.querySelector(".add-popup__input_description_link"),i.querySelector(".profile__add-button")),l=i.querySelector(".profile__edit-button"),p={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},c=new e(p,r),u=new e(p,o);u.enableValidation(),c.enableValidation();const d=new class extends s{constructor(e){super(e),this._imagePopupImg=this._popup.querySelector(".image-popup__img"),this._imagePopupTitle=this._popup.querySelector(".image-popup__title")}open(e,t){this._imagePopupImg.src=e,this._imagePopupTitle.textContent=t,this._imagePopupImg.alt=t,super.open()}}(".image-popup");d.setEventListeners();const _=new class{constructor({userNameSelector:e,userInfoSelector:t}){this._name=document.querySelector(e),this._info=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,info:this._info.textContent}}setUserInfo(e,t){this._name.textContent=e,this._info.textContent=t}}({userNameSelector:".profile__name",userInfoSelector:".profile__about-me"}),m=e=>new t(e,"#elements-template",((e,t)=>{d.open(e,t)})).createElement(),h=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{h.addItem(m(e))}},"#elements-list");h.renderItems();const v=new n(".add-popup",(function(e,t){e.preventDefault(),h.addItem(m(t)),v.close()}));v.setEventListeners();const f=new n(".profile-popup",(function(e,t){e.preventDefault(),t&&(_.setUserInfo(t.name,t.info),f.close())}));f.setEventListeners(),a.addEventListener("click",(()=>{v.open(),c.toggleButtonState(),c.resetInputError()})),l.addEventListener("click",(()=>{const{name:e,info:t}=_.getUserInfo();f.setFormvalues({name:e,info:t}),u.toggleButtonState(),u.resetInputError(),f.open()}))})();